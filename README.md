# Домашнее задание по веб-разработке

## React

#   Отчет

### «Разработка веб-приложения интернет-магазина фруктов на React JS»

---

## 1. ОПИСАНИЕ ПРЕДМЕТНОЙ ОБЛАСТИ

Разработано **веб-приложение интернет-магазина фруктов** — прототип многостраничного SPA (Single Page Application), соответствующее требованиям предметной области «Фрукты». Приложение позволяет:

- **Просматривать каталог** свежих фруктов с фотографиями
- **Осуществлять вход** в систему для доступа к защищённым разделам
- **Просматривать детальную информацию** о каждом товаре
- **Работать с пагинацией** для удобной навигации по большому каталогу
- **Обрабатывать состояния** загрузки и ошибок сети

**Целевая аудитория:** покупатели, желающие заказать свежие фрукты онлайн.

---

## 2. АРХИТЕКТУРА ПРОЕКТА

### 2.1 Клиентская часть (React SPA)
```
src/
├── components/           # Переиспользуемые компоненты
│   ├── Header.js        # Шапка сайта с навигацией
│   ├── ProtectedRoute.js # Компонент для защиты маршрутов
│   └── ProductCard.js   # Карточка товара
├── pages/               # Страницы приложения
│   ├── HomePage.js      # Главная страница
│   ├── LoginPage.js     # Страница входа
│   ├── ProductsPage.js  # Страница списка товаров
│   └── ProductDetailPage.js # Страница деталей товара
├── hooks/               # Кастомные хуки
│   └── useServerGoods.js # Хук для работы с сервером (★обязательный★)
├── context/             # Глобальное состояние
│   └── AuthContext.js   # Контекст авторизации
├── App.js               # Главный компонент с маршрутизацией
└── App.css              # Глобальные стили
```

**Технологический стек клиента:**
- **React 18** с функциональными компонентами
- **React Router v6** для маршрутизации
- **React Context API** для управления состоянием авторизации
- **Custom Hooks** для инкапсуляции бизнес-логики
- **Fetch API** для HTTP-запросов

### 2.2 Серверная часть (PHP API)
```
/opt/lampp/htdocs/
├── api/
│   └── fruits.php      # REST API endpoint
├── images/              # Статические изображения
│   ├── homepage.png    # Фото для главной страницы
│   └── fruits/         # Фотографии фруктов (15 шт.)
│       ├── fruit1.png
│       └── ...
└── ...                 # Собранное React-приложение
```

**Серверная архитектура:**
- **Веб-сервер:** Apache (XAMPP)
- **Язык:** PHP 8.2
- **Протокол:** RESTful API
- **Данные:** Мок-данные в виде PHP-массива
- **Кодировка:** UTF-8, JSON-ответы

---

## 3. ОПИСАНИЕ РЕАЛИЗОВАННЫХ ФУНКЦИЙ

### 3.1 Основной функционал

| Функция | Реализация | Компонент/Файл |
|---------|------------|----------------|
| **Многостраничная навигация** | 4 страницы с уникальными маршрутами | `App.js`, React Router |
| **Авторизация пользователей** | Форма входа, защита маршрутов | `LoginPage.js`, `ProtectedRoute.js` |
| **Загрузка списка товаров** | Пагинация, индикация загрузки | `ProductsPage.js`, `useServerGoods.js` |
| **Просмотр деталей товара** | Динамический роут с параметром ID | `ProductDetailPage.js` |
| **Обработка ошибок сети** | Сообщения об ошибках, кнопка повтора | `useServerGoods.js` |
| **Пагинация** | Кнопка "Загрузить больше", параметры page/limit | `useServerGoods.js`, `fruits.php` |

### 3.2 Ключевые сценарии работы

1. **Неавторизованный пользователь:**
   - Видит главную страницу с приветствием
   - Может перейти на страницу входа
   - При попытке доступа к `/products` — автоматический редирект на `/login`

2. **Авторизованный пользователь:**
   - Просматривает каталог фруктов с фотографиями
   - Использует пагинацию для загрузки дополнительных товаров
   - Переходит на страницу деталей любого товара
   - Видит актуальные цены и даты поступления

3. **Обработка ошибок:**
   - При обрыве соединения — сообщение «Ошибка соединения»
   - Во время загрузки — индикатор «Загрузка...»
   - Возможность повтора запроса при ошибке

---

## 4. ЛОГИКА МАРШРУТИЗАЦИИ

### 4.1 Структура маршрутов

```javascript
// App.js - конфигурация маршрутов
<Routes>
  <Route path="/" element={<HomePage />} />                    // Главная
  <Route path="/login" element={<LoginPage />} />             // Вход
  <Route path="/products" element={                           // Товары
    <ProtectedRoute>
      <ProductsPage />
    </ProtectedRoute>
  } />
  <Route path="/products/:id" element={                       // Детали товара
    <ProtectedRoute>
      <ProductDetailPage />
    </ProtectedRoute>
  } />
  <Route path="*" element={<Navigate to="/" />} />            // Fallback
</Routes>
```

### 4.2 Механизм защиты маршрутов

**Компонент `ProtectedRoute.js`:**
- Проверяет статус авторизации через `AuthContext`
- Если пользователь не авторизован — редирект на `/login`
- Использует `Navigate` из React Router для бесшовного перенаправления

### 4.3 Передача параметров
- **Динамические параметры:** `/products/:id` → `useParams()` в `ProductDetailPage`
- **Защита данных:** Все запросы к API проходят CORS-валидацию

---

## 5. ОПИСАНИЕ ХУКА `useServerGoods`

### 5.1 Назначение и архитектура

**Кастомный хук `useServerGoods`** — центральный элемент клиент-серверного взаимодействия, реализующий:

1. **Управление состоянием:** `loading`, `error`, `products`, `hasMore`
2. **Пагинацию:** параметры `page` и `limit`, метод `loadMore()`
3. **Обработку ошибок:** перехват исключений, сообщения пользователю
4. **Повторные запросы:** функция `retry()` для восстановления после ошибок

### 5.2 Ключевые методы

```javascript
const useServerGoods = (initialPage = 1, limit = 10) => {
  // Состояния
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  const [page, setPage] = useState(initialPage);
  const [hasMore, setHasMore] = useState(true);

  // Основной метод загрузки
  const fetchProducts = async (pageNum) => {
    setLoading(true);
    setError(null);
    
    try {
      const response = await fetch(
        `http://localhost/api/fruits.php?page=${pageNum}&limit=${limit}`
      );
      
      if (!response.ok) throw new Error('Ошибка соединения');
      
      const data = await response.json();
      
      // Обновление состояния с учётом пагинации
      if (pageNum === 1) {
        setProducts(data.products);
      } else {
        setProducts(prev => [...prev, ...data.products]);
      }
      
      setHasMore(data.hasMore);
      setPage(pageNum);
      
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  // Метод для пагинации
  const loadMore = () => {
    if (!loading && hasMore) {
      fetchProducts(page + 1);
    }
  };

  // Инициализация
  useEffect(() => {
    fetchProducts(1);
  }, []);

  return { products, loading, error, hasMore, loadMore, retry: () => fetchProducts(1) };
};
```

### 5.3 Принципы работы

1. **Инкапсуляция:** Вся логика работы с API скрыта внутри хука
2. **Переиспользуемость:** Хук можно использовать в разных компонентах
3. **Изоляция состояния:** Каждый вызов хука создаёт независимое состояние
4. **Оптимизация:** Используется `useCallback` для мемоизации функций

---

## 6. ПРИМЕРЫ ЗАПРОСОВ К API

### 6.1 Базовая структура API

**Endpoint:** `GET http://localhost/api/fruits.php`

**Параметры:**
- `page` — номер страницы (начинается с 1)
- `limit` — количество товаров на странице

### 6.2 Примеры запросов и ответов

#### Запрос 1: Первая страница (10 товаров)
```bash
curl "http://localhost/api/fruits.php?page=1&limit=10"
```

**Ответ:**
```json
{
  "products": [
    {
      "id": 1,
      "name": "Яблоки",
      "price": 120,
      "releaseDate": "2024-03-15",
      "description": "Свежие сладкие яблоки",
      "image": "fruit1.png",
      "category": "Фрукты"
    },
    // ... 9 других товаров
  ],
  "total": 15,
  "page": 1,
  "limit": 10,
  "hasMore": true
}
```

#### Запрос 2: Вторая страница (оставшиеся 5 товаров)
```bash
curl "http://localhost/api/fruits.php?page=2&limit=10"
```

**Ответ:**
```json
{
  "products": [
    {
      "id": 11,
      "name": "Арбуз",
      "price": 45,
      "releaseDate": "2024-02-25",
      "description": "Сладкий арбуз",
      "image": "fruit11.png",
      "category": "Бахчевые"
    },
    // ... 4 других товара
  ],
  "total": 15,
  "page": 2,
  "limit": 10,
  "hasMore": false
}
```

### 6.3 Особенности реализации API

1. **Пагинация:** Реализована через `array_slice()` в PHP
2. **CORS поддержка:** Заголовки для кросс-доменных запросов
3. **Структурированный ответ:** Всегда содержит метаданные пагинации
4. **Стабильность:** Возвращает предсказуемую структуру даже при ошибках

---

## 7. ВЫВОДЫ

✅ **Реализованы все требования задания:**
- Разработано SPA-приложение с 4 страницами
- Реализована маршрутизация с защитой доступа
- Создан кастомный хук `useServerGoods` для работы с API
- Реализована пагинация с параметрами `page`/`limit`
- Обеспечена обработка состояний загрузки и ошибок
- Приложение собрано и развёрнуто на XAMPP

✅ **Дополнительные улучшения:**
- Визуальное оформление с фотографиями фруктов
- Адаптивная вёрстка для карточек товаров
- Пользовательский опыт с понятными состояниями
- Чистая архитектура с разделением ответственности

###Технические выводы

1. **React + хуки** эффективны для создания интерактивных SPA
2. **Кастомные хуки** позволяют инкапсулировать сложную бизнес-логику
3. **Context API** подходит для управления глобальным состоянием авторизации
4. **REST API на PHP** — простое и эффективное решение для прототипов
5. **Пагинация "load more"** улучшает UX при работе с большими списками

-----------
**Технологии:** React, PHP, REST API, XAMPP
